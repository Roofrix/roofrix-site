<div class="orders-page">
  <!-- Page Header -->
  <div class="page-header">
    <div>
      <h1 class="page-title">My Orders</h1>
      <p class="page-subtitle">View and track your rooftop design orders</p>
    </div>
    <button class="btn-primary" (click)="createNewOrder()">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="12" y1="8" x2="12" y2="16"></line>
        <line x1="8" y1="12" x2="16" y2="12"></line>
      </svg>
      New Order
    </button>
  </div>

  <!-- Loading State -->
  <div class="loading-container" *ngIf="loading">
    <div class="spinner"></div>
    <p>Loading your orders...</p>
  </div>

  <!-- Error State -->
  <div class="error-message" *ngIf="error && !loading">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <circle cx="12" cy="12" r="10"></circle>
      <line x1="12" y1="8" x2="12" y2="12"></line>
      <line x1="12" y1="16" x2="12.01" y2="16"></line>
    </svg>
    <p>{{ error }}</p>
  </div>

  <!-- Orders List -->
  <div class="orders-container" *ngIf="!loading && !error">
    <ng-container *ngIf="orders$ | async as orders">
      <!-- Empty State -->
      <div class="empty-state" *ngIf="orders.length === 0">
        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
        </svg>
        <h3>No orders yet</h3>
        <p>Start by creating your first rooftop design order</p>
        <button class="btn-primary" (click)="createNewOrder()">Create Order</button>
      </div>

      <!-- Orders Grid -->
      <div class="orders-grid" *ngIf="orders.length > 0">
      <div class="order-card" *ngFor="let order of orders" (click)="viewOrderDetails(order.id)">
        <div class="order-header">
          <div class="order-number">{{ order.orderNumber }}</div>
          <span class="status-badge" [ngClass]="getStatusClass(order.status)">
            {{ getStatusLabel(order.status) }}
          </span>
        </div>

        <div class="order-body">
          <h3 class="project-name">{{ order.projectName }}</h3>
          <p class="project-address">{{ order.projectAddress }}</p>

          <div class="order-meta">
            <div class="meta-item">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                <line x1="16" y1="2" x2="16" y2="6"></line>
                <line x1="8" y1="2" x2="8" y2="6"></line>
                <line x1="3" y1="10" x2="21" y2="10"></line>
              </svg>
              <span>{{ formatDate(order.createdAt) }}</span>
            </div>

            <div class="meta-item" *ngIf="order.assignedDesignerEmail">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"></path>
                <circle cx="12" cy="7" r="4"></circle>
              </svg>
              <span>{{ order.assignedDesignerEmail }}</span>
            </div>

            <div class="meta-item" *ngIf="order.priority">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="16" x2="12" y2="12"></line>
                <line x1="12" y1="8" x2="12.01" y2="8"></line>
              </svg>
              <span class="priority" [class.high]="order.priority === 'high'" [class.medium]="order.priority === 'medium'">
                {{ order.priority | titlecase }} Priority
              </span>
            </div>
          </div>

          <div class="order-images" *ngIf="order.siteImages && order.siteImages.length > 0">
            <div class="image-count">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                <polyline points="21 15 16 10 5 21"></polyline>
              </svg>
              {{ order.siteImages.length }} image{{ order.siteImages.length !== 1 ? 's' : '' }}
            </div>
          </div>
        </div>

        <div class="order-footer">
          <button class="btn-view">View Details</button>
        </div>
      </div>
      </div>
    </ng-container>
  </div>
</div>
