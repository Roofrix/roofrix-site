<header class="navbar">
  <div class="logo">ROOFRIX</div>

  <!-- Mobile Menu Toggle -->
  <button class="mobile-menu-toggle" (click)="toggleMobileMenu()" *ngIf="(isAuthenticated$ | async) === false">
    <svg *ngIf="!mobileMenuOpen" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
    <svg *ngIf="mobileMenuOpen" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <line x1="18" y1="6" x2="6" y2="18"></line>
      <line x1="6" y1="6" x2="18" y2="18"></line>
    </svg>
  </button>

  <nav [class.mobile-open]="mobileMenuOpen">
    <a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }" (click)="mobileMenuOpen = false">Home</a>
    <a routerLink="/features" routerLinkActive="active" (click)="mobileMenuOpen = false">Features</a>
    <a routerLink="/pricing" routerLinkActive="active" (click)="mobileMenuOpen = false">Pricing</a>
    <a routerLink="/about" routerLinkActive="active" (click)="mobileMenuOpen = false">About</a>
    <a routerLink="/contact" routerLinkActive="active" (click)="mobileMenuOpen = false">Contact</a>
  </nav>

  <!-- Auth buttons when NOT logged in -->
  <div class="auth-buttons" *ngIf="(isAuthenticated$ | async) === false">
    <button class="signin-button" (click)="navigateToSignin()">Sign In</button>
    <button class="cta" (click)="navigateToSignup()">Get Started</button>
  </div>

  <!-- Orders dropdown and User menu when logged in -->
  <div class="logged-in-section" *ngIf="isAuthenticated$ | async">
    <!-- Order Dropdown Menu -->
    <div class="order-menu" *ngIf="userProfile$ | async as profile">
      <button class="order-menu-btn" (click)="toggleOrderMenu()">
        <span>Orders</span>
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="6 9 12 15 18 9"></polyline>
        </svg>
      </button>

      <div class="dropdown-menu" *ngIf="showOrderMenu">
        <!-- Customer Menu Items -->
        <ng-container *ngIf="profile.role === 'customer'">
          <button (click)="navigateTo('/dashboard/customer/new-order')" class="dropdown-item">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"></circle>
              <line x1="12" y1="8" x2="12" y2="16"></line>
              <line x1="8" y1="12" x2="16" y2="12"></line>
            </svg>
            Order
          </button>
          <button (click)="navigateTo('/dashboard/customer/orders')" class="dropdown-item">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
            </svg>
            Order History
          </button>
        </ng-container>

        <!-- Admin Menu Items -->
        <ng-container *ngIf="profile.role === 'admin'">
          <button (click)="navigateTo('/dashboard/admin/orders')" class="dropdown-item">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
            </svg>
            Order History
          </button>
        </ng-container>

        <!-- Designer Menu Items -->
        <ng-container *ngIf="profile.role === 'designer'">
          <button (click)="navigateTo('/dashboard/designer/orders')" class="dropdown-item">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
            </svg>
            Assigned Orders
          </button>
        </ng-container>
      </div>
    </div>

    <!-- User menu -->
    <div class="user-menu">
      <button class="user-button" (click)="toggleUserMenu()">
        <div class="user-avatar" *ngIf="userProfile$ | async as profile">
          {{ (profile.email || 'U').charAt(0).toUpperCase() }}
        </div>
        <span class="user-email">{{ (currentUser$ | async)?.email }}</span>
        <span class="dropdown-arrow">â–¼</span>
      </button>

      <div class="user-dropdown" *ngIf="showUserMenu">
        <div class="user-info-dropdown" *ngIf="userProfile$ | async as profile">
          <div class="user-role-badge">{{ profile.role | titlecase }}</div>
        </div>
        <button class="dropdown-item" (click)="signOut()">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4"></path>
            <polyline points="16 17 21 12 16 7"></polyline>
            <line x1="21" y1="12" x2="9" y2="12"></line>
          </svg>
          Sign Out
        </button>
      </div>
    </div>
  </div>
</header>
