import{a as V}from"./chunk-GWCAXF66.js";import{f as R}from"./chunk-FTFMUACC.js";import{d as T}from"./chunk-6VCXNJ72.js";import{g as D,h as E,k as I}from"./chunk-BDAGTHR3.js";import{$a as y,Ga as M,La as l,P as f,Sa as d,Ta as t,U as h,Ua as n,V as v,Va as x,W as m,X as u,Za as C,_a as O,ab as b,ba as P,cb as c,jb as i,kb as _,lb as p,mb as S,o as w,ua as o,yb as k}from"./chunk-U4S3JRSN.js";function N(r,a){if(r&1&&(t(0,"div",26),m(),t(1,"svg",4),x(2,"circle",22)(3,"line",27)(4,"line",28),n(),u(),t(5,"span"),i(6),n()()),r&2){let e=c(2);o(6),_(e.errorMessage)}}function F(r,a){if(r&1&&(t(0,"p",29),m(),t(1,"svg",30),x(2,"path",31)(3,"circle",32),n(),i(4),n()),r&2){let e=c(2);o(4),S(" Lat: ",e.orderData.latitude.toFixed(6),", Lng: ",e.orderData.longitude.toFixed(6)," ")}}function B(r,a){if(r&1&&(t(0,"div",15)(1,"span"),i(2),n(),t(3,"span"),i(4),n()()),r&2){let e=a.$implicit;o(2),_(e.name),o(2),p("$",e.price.toFixed(2))}}function q(r,a){if(r&1&&(t(0,"div",13)(1,"h3"),i(2,"Addons"),n(),l(3,B,5,2,"div",33),n()),r&2){let e=c(2);o(3),d("ngForOf",e.orderData.addons)}}function H(r,a){if(r&1&&(t(0,"span",36),i(1),n()),r&2){let e=c(3);o(),p("(",e.orderData.structureCategorySqRange,")")}}function L(r,a){if(r&1&&(t(0,"div",13)(1,"h3"),i(2,"Structure Category"),n(),t(3,"p",34),i(4),l(5,H,2,1,"span",35),n()()),r&2){let e=c(2);o(4),p(" ",e.orderData.structureCategoryName," "),o(),d("ngIf",e.orderData.structureCategorySqRange)}}function $(r,a){if(r&1&&(t(0,"div",18)(1,"span"),i(2,"Addons"),n(),t(3,"span"),i(4),n()()),r&2){let e=c(2);o(4),p("$",e.orderData.addonsTotal.toFixed(2))}}function G(r,a){r&1&&(t(0,"span"),i(1,"Confirm Order"),n())}function j(r,a){r&1&&(t(0,"span"),i(1,"Processing..."),n())}function A(r,a){if(r&1){let e=y();C(0),t(1,"div",2)(2,"button",3),b("click",function(){h(e);let g=c();return v(g.goBack())}),m(),t(3,"svg",4),x(4,"polyline",5),n(),i(5," Back to Order "),n(),u(),t(6,"h1"),i(7,"Order Review"),n(),t(8,"p"),i(9,"Please review your order before confirming"),n()(),l(10,N,7,1,"div",6),t(11,"div",7)(12,"div",8),m(),t(13,"svg",9),x(14,"path",10)(15,"rect",11),n(),u(),t(16,"h2"),i(17,"Order Summary"),n()(),t(18,"div",12)(19,"div",13)(20,"h3"),i(21,"Property Address"),n(),t(22,"p"),i(23),n(),l(24,F,5,2,"p",14),n(),t(25,"div",13)(26,"h3"),i(27,"Report Type"),n(),t(28,"div",15)(29,"span"),i(30),n(),t(31,"span"),i(32),n()()(),l(33,q,4,1,"div",16)(34,L,6,2,"div",16),t(35,"div",17)(36,"div",18)(37,"span"),i(38,"Subtotal"),n(),t(39,"span"),i(40),n()(),l(41,$,5,1,"div",19),t(42,"div",20)(43,"span"),i(44,"Total"),n(),t(45,"span"),i(46),n()()()(),t(47,"div",21),m(),t(48,"svg",4),x(49,"circle",22)(50,"line",23)(51,"line",24),n(),u(),t(52,"span"),i(53,"Payment integration coming soon. Your order will be processed for review."),n()(),t(54,"button",25),b("click",function(){h(e);let g=c();return v(g.confirmOrder())}),l(55,G,2,0,"span",1)(56,j,2,0,"span",1),n()(),O()}if(r&2){let e=c();o(10),d("ngIf",e.errorMessage),o(13),_(e.orderData.address),o(),d("ngIf",e.orderData.latitude&&e.orderData.longitude),o(6),_(e.orderData.reportType.name),o(2),p("$",e.orderData.reportType.price.toFixed(2)),o(),d("ngIf",e.orderData.addons&&e.orderData.addons.length>0),o(),d("ngIf",e.orderData.structureCategoryName),o(6),p("$",e.orderData.basePrice.toFixed(2)),o(),d("ngIf",e.orderData.addonsTotal>0),o(5),p("$",e.orderData.totalPrice.toFixed(2)),o(8),d("disabled",e.loading),o(),d("ngIf",!e.loading),o(),d("ngIf",e.loading)}}function Z(r,a){if(r&1){let e=y();C(0),t(1,"div",37)(2,"div",38),m(),t(3,"svg",39),x(4,"path",40)(5,"polyline",41),n()(),u(),t(6,"h1"),i(7,"Order Confirmed!"),n(),t(8,"p",42),i(9,"Order Number: "),t(10,"strong"),i(11),n()(),t(12,"p",43),i(13,"Thank you for your order. We will process it shortly."),n(),t(14,"div",44)(15,"button",45),b("click",function(){h(e);let g=c();return v(g.goToOrders())}),i(16,"View Order History"),n(),t(17,"button",46),b("click",function(){h(e);let g=c();return v(g.goToProducts())}),i(18,"Continue Shopping"),n()()(),O()}if(r&2){let e=c();o(11),_(e.orderNumber)}}var z=class r{router=f(T);cdr=f(k);ngZone=f(P);orderService=f(V);authService=f(R);orderData=null;orderConfirmed=!1;orderNumber="";loading=!1;errorMessage="";ngOnInit(){let a=sessionStorage.getItem("orderData");a?this.orderData=JSON.parse(a):this.router.navigate(["/dashboard/customer/orders/products"])}goBack(){this.router.navigate(["/dashboard/customer/new-order"])}async confirmOrder(){this.loading=!0,this.errorMessage="";try{let a=await w(this.authService.currentUser$);if(!a){this.errorMessage="Please sign in to place an order",this.loading=!1;return}let e={customerId:a.uid,customerEmail:a.email||"",customerName:a.displayName||a.email||"Customer",projectAddress:this.orderData.address,latitude:this.orderData.latitude||null,longitude:this.orderData.longitude||null,location:this.orderData.location||null,reportType:this.orderData.reportType,addons:this.orderData.addons||[],structureCategory:this.orderData.structureCategory||"basic",structureCategoryName:this.orderData.structureCategoryName||"Basic Structure",structureCategorySqRange:this.orderData.structureCategorySqRange||"< 30 SQs",primaryPitch:this.orderData.primaryPitch||"",secondaryPitch:this.orderData.secondaryPitch||"",specialInstructions:this.orderData.specialInstructions||"",basePrice:this.orderData.basePrice,addonsTotal:this.orderData.addonsTotal,totalPrice:this.orderData.totalPrice,priority:"medium"},s=await this.orderService.createOrder(e,a.uid);this.orderNumber="ORD-"+s.slice(-8).toUpperCase(),this.ngZone.run(()=>{this.loading=!1,this.orderConfirmed=!0,sessionStorage.removeItem("selectedProduct"),sessionStorage.removeItem("orderData"),this.cdr.detectChanges()})}catch(a){console.error("Error creating order:",a),this.ngZone.run(()=>{this.errorMessage="Failed to create order. Please try again.",this.loading=!1,this.cdr.detectChanges()})}}goToProducts(){this.router.navigate(["/dashboard/customer/orders/products"])}goToOrders(){this.router.navigate(["/dashboard/customer/orders"])}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=M({type:r,selectors:[["app-order-review"]],decls:3,vars:2,consts:[[1,"review-page"],[4,"ngIf"],[1,"page-header"],[1,"btn-back",3,"click"],["width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["points","15 18 9 12 15 6"],["class","alert alert-error",4,"ngIf"],[1,"review-card"],[1,"card-header"],["width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["d","M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"],["x","9","y","3","width","6","height","4","rx","1"],[1,"order-details"],[1,"detail-section"],["class","coordinates",4,"ngIf"],[1,"detail-row"],["class","detail-section",4,"ngIf"],[1,"summary-section"],[1,"summary-line"],["class","summary-line",4,"ngIf"],[1,"summary-line","total"],[1,"payment-note"],["cx","12","cy","12","r","10"],["x1","12","y1","16","x2","12","y2","12"],["x1","12","y1","8","x2","12.01","y2","8"],[1,"btn-confirm",3,"click","disabled"],[1,"alert","alert-error"],["x1","12","y1","8","x2","12","y2","12"],["x1","12","y1","16","x2","12.01","y2","16"],[1,"coordinates"],["width","14","height","14","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["d","M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"],["cx","12","cy","10","r","3"],["class","detail-row",4,"ngFor","ngForOf"],[1,"structure-category-badge"],["class","sq-range",4,"ngIf"],[1,"sq-range"],[1,"confirmation-card"],[1,"success-icon"],["width","48","height","48","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["d","M22 11.08V12a10 10 0 1 1-5.93-9.14"],["points","22 4 12 14.01 9 11.01"],[1,"order-number"],[1,"thank-you"],[1,"confirmation-actions"],[1,"btn-primary",3,"click"],[1,"btn-secondary",3,"click"]],template:function(e,s){e&1&&(t(0,"div",0),l(1,A,57,13,"ng-container",1)(2,Z,19,1,"ng-container",1),n()),e&2&&(o(),d("ngIf",!s.orderConfirmed&&s.orderData),o(),d("ngIf",s.orderConfirmed))},dependencies:[I,D,E],styles:[".review-page[_ngcontent-%COMP%]{padding:30px;max-width:700px;margin:0 auto}.page-header[_ngcontent-%COMP%]{margin-bottom:30px}.btn-back[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;background:none;border:none;color:#3b82f6;font-size:14px;font-weight:500;cursor:pointer;padding:0;margin-bottom:16px}.btn-back[_ngcontent-%COMP%]:hover{color:#2563eb}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:28px;font-weight:700;color:#1e293b;margin-bottom:8px}.page-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:#64748b}.alert[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:14px 16px;border-radius:8px;margin-bottom:20px}.alert-error[_ngcontent-%COMP%]{background:#fef2f2;color:#dc2626}.review-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:28px;box-shadow:0 2px 8px #00000014}.card-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:24px;padding-bottom:16px;border-bottom:1px solid #e2e8f0}.card-header[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{stroke:#3b82f6}.card-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:20px;font-weight:600;color:#1e293b}.detail-section[_ngcontent-%COMP%]{margin-bottom:20px}.detail-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#64748b;text-transform:uppercase;letter-spacing:.5px;margin-bottom:8px}.detail-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:15px;color:#1e293b}.detail-section[_ngcontent-%COMP%]   .coordinates[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;margin-top:8px;font-size:12px;color:#64748b}.detail-section[_ngcontent-%COMP%]   .coordinates[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{stroke:#0891b2;flex-shrink:0}.detail-section[_ngcontent-%COMP%]   .structure-category-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:8px;font-weight:500;color:#1e3a5f}.detail-section[_ngcontent-%COMP%]   .structure-category-badge[_ngcontent-%COMP%]   .sq-range[_ngcontent-%COMP%]{font-weight:400;color:#64748b;font-size:13px}.detail-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:8px 0;font-size:14px;color:#1e293b}.summary-section[_ngcontent-%COMP%]{padding:16px;background:#f8fafc;border-radius:8px;margin-top:20px;margin-bottom:20px}.summary-line[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:8px 0;font-size:14px;color:#475569}.summary-line.total[_ngcontent-%COMP%]{border-top:1px solid #e2e8f0;margin-top:8px;padding-top:12px;font-size:18px;font-weight:700;color:#1e293b}.summary-line.total[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{color:#3b82f6}.payment-note[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:10px;padding:14px 16px;background:#fef3c7;border-radius:8px;margin-bottom:24px}.payment-note[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{stroke:#d97706;flex-shrink:0;margin-top:2px}.payment-note[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:13px;color:#92400e;line-height:1.5}.btn-confirm[_ngcontent-%COMP%]{width:100%;padding:16px 24px;background:linear-gradient(135deg,#10b981,#059669);color:#fff;border:none;border-radius:8px;font-size:16px;font-weight:600;cursor:pointer;transition:all .2s ease}.btn-confirm[_ngcontent-%COMP%]:hover:not(:disabled){background:linear-gradient(135deg,#059669,#047857)}.btn-confirm[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed}.confirmation-card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:48px;box-shadow:0 4px 16px #0000001a;text-align:center;margin-top:50px}.success-icon[_ngcontent-%COMP%]{width:80px;height:80px;background:#d1fae5;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 24px}.success-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{stroke:#10b981}.confirmation-card[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:28px;font-weight:700;color:#1e293b;margin-bottom:12px}.order-number[_ngcontent-%COMP%]{font-size:16px;color:#64748b;margin-bottom:8px}.order-number[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#3b82f6}.thank-you[_ngcontent-%COMP%]{font-size:14px;color:#64748b;margin-bottom:32px}.confirmation-actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.btn-primary[_ngcontent-%COMP%]{width:100%;padding:14px 24px;background:linear-gradient(135deg,#1e3a5f,#2d4a6f);color:#fff;border:none;border-radius:8px;font-size:15px;font-weight:600;cursor:pointer;transition:all .2s ease}.btn-primary[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#2d4a6f,#3d5a7f)}.btn-secondary[_ngcontent-%COMP%]{width:100%;padding:14px 24px;background:#fff;color:#1e3a5f;border:1px solid #e2e8f0;border-radius:8px;font-size:15px;font-weight:600;cursor:pointer;transition:all .2s ease}.btn-secondary[_ngcontent-%COMP%]:hover{background:#f8fafc;border-color:#cbd5e1}@media(max-width:600px){.review-page[_ngcontent-%COMP%]{padding:20px 16px}.review-card[_ngcontent-%COMP%]{padding:20px}.confirmation-card[_ngcontent-%COMP%]{padding:32px 24px}}"]})};export{z as OrderReview};
