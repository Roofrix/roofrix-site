import{e as E,f as I}from"./chunk-FTFMUACC.js";import{b as v,d as O,e as S}from"./chunk-6VCXNJ72.js";import{b as y,c,d as F,e as k,g as D,i as z,j as T,n as U,p as q}from"./chunk-QESJGVXS.js";import{h as P,k as M}from"./chunk-BDAGTHR3.js";import{E as f,Ga as w,La as l,P as d,Sa as p,Ta as r,Ua as i,Va as h,ab as x,ba as _,cb as u,hb as b,jb as s,lb as g,ua as a,yb as C,z as m}from"./chunk-U4S3JRSN.js";function A(o,n){if(o&1&&(r(0,"div",17),s(1),i()),o&2){let t=u();a(),g(" ",t.errorMessage," ")}}function R(o,n){if(o&1&&(r(0,"span",18),s(1),i()),o&2){let t=u();a(),g(" ",t.getErrorMessage("email")," ")}}function V(o,n){if(o&1&&(r(0,"span",18),s(1),i()),o&2){let t=u();a(),g(" ",t.getErrorMessage("password")," ")}}function L(o,n){o&1&&(r(0,"span"),s(1,"Sign In"),i())}function Z(o,n){o&1&&(r(0,"span"),s(1,"Signing In..."),i())}var N=class o{fb=d(U);authService=d(I);userService=d(E);router=d(O);route=d(v);cdr=d(C);ngZone=d(_);signInForm;loading=!1;errorMessage="";showPassword=!1;returnUrl="";ngOnInit(){this.returnUrl=this.route.snapshot.queryParams.returnUrl||"",this.signInForm=this.fb.group({email:["",[c.required,c.email]],password:["",[c.required,c.minLength(8)]]})}togglePasswordVisibility(){this.showPassword=!this.showPassword}onSubmit(){if(this.signInForm.invalid){this.markFormGroupTouched(this.signInForm);return}this.loading=!0,this.errorMessage="";let{email:n,password:t}=this.signInForm.value;this.authService.signIn(n,t).pipe(f(e=>{if(console.log("Sign in result:",e),!e.success)throw console.log("Sign in failed with error:",e.error),new Error(e.error||"Sign in failed");return this.authService.currentUser$.pipe(m(1))}),f(e=>{if(!e)throw new Error("User not found");return this.userService.userProfileListener(e.uid).pipe(m(1))})).subscribe({next:e=>{this.ngZone.run(()=>{if(!e){this.errorMessage="User profile not found",this.loading=!1,this.cdr.detectChanges();return}this.returnUrl?this.router.navigate([this.returnUrl]):e.role==="admin"?this.router.navigate(["/dashboard/admin/orders"]):e.role==="designer"?this.router.navigate(["/dashboard/designer/orders"]):this.router.navigate(["/dashboard/customer/new-order"])})},error:e=>{this.ngZone.run(()=>{console.log("Sign in subscribe error:",e),this.errorMessage=e.message||"An unexpected error occurred. Please try again.",this.loading=!1,this.cdr.detectChanges()})}})}markFormGroupTouched(n){Object.keys(n.controls).forEach(t=>{n.get(t)?.markAsTouched()})}hasError(n,t){let e=this.signInForm.get(n);return!!(e&&e.hasError(t)&&e.touched)}getErrorMessage(n){let t=this.signInForm.get(n);if(!t||!t.touched)return"";if(n==="email"){if(t.hasError("required"))return"Email is required";if(t.hasError("email"))return"Please enter a valid email address"}if(n==="password"){if(t.hasError("required"))return"Password is required";if(t.hasError("minlength"))return"Password must be at least 8 characters"}return""}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=w({type:o,selectors:[["app-signin"]],decls:29,vars:13,consts:[[1,"auth-container"],[1,"auth-card"],[1,"auth-header"],[1,"auth-form",3,"ngSubmit","formGroup"],["class","error-alert",4,"ngIf"],[1,"form-group"],["for","email"],["type","email","id","email","formControlName","email","placeholder","you@example.com","autocomplete","email"],["class","error-message",4,"ngIf"],["for","password"],[1,"password-input-wrapper"],["id","password","formControlName","password","placeholder","Enter your password","autocomplete","current-password",3,"type"],["type","button","tabindex","-1",1,"password-toggle",3,"click"],["type","submit",1,"submit-button",3,"disabled"],[4,"ngIf"],[1,"auth-link"],["routerLink","/signup"],[1,"error-alert"],[1,"error-message"]],template:function(t,e){t&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),s(4,"Welcome Back"),i(),r(5,"p"),s(6,"Sign in to your account to continue"),i()(),r(7,"form",3),x("ngSubmit",function(){return e.onSubmit()}),l(8,A,2,1,"div",4),r(9,"div",5)(10,"label",6),s(11,"Email Address"),i(),h(12,"input",7),l(13,R,2,1,"span",8),i(),r(14,"div",5)(15,"label",9),s(16,"Password"),i(),r(17,"div",10),h(18,"input",11),r(19,"button",12),x("click",function(){return e.togglePasswordVisibility()}),s(20),i()(),l(21,V,2,1,"span",8),i(),r(22,"button",13),l(23,L,2,0,"span",14)(24,Z,2,0,"span",14),i(),r(25,"div",15),s(26," Don't have an account? "),r(27,"a",16),s(28,"Sign Up"),i()()()()()),t&2&&(a(7),p("formGroup",e.signInForm),a(),p("ngIf",e.errorMessage),a(4),b("error",e.hasError("email","required")||e.hasError("email","email")),a(),p("ngIf",e.getErrorMessage("email")),a(5),b("error",e.hasError("password","required")||e.hasError("password","minlength")),p("type",e.showPassword?"text":"password"),a(2),g(" ",e.showPassword?"\u{1F441}\uFE0F":"\u{1F441}\uFE0F\u200D\u{1F5E8}\uFE0F"," "),a(),p("ngIf",e.getErrorMessage("password")),a(),p("disabled",e.loading),a(),p("ngIf",!e.loading),a(),p("ngIf",e.loading))},dependencies:[M,P,q,D,y,F,k,T,z,S],styles:[".auth-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;min-height:calc(100vh - 140px);padding:40px 20px}.auth-card[_ngcontent-%COMP%]{width:100%;max-width:440px;background:#fff;border-radius:16px;padding:40px;box-shadow:0 4px 20px #0f172a14}.auth-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:32px}.auth-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:32px;font-weight:800;color:#0f172a;margin:0 0 8px}.auth-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:15px;color:#64748b;margin:0}.auth-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.error-alert[_ngcontent-%COMP%]{background:#fef2f2;border:1px solid #fecaca;color:#991b1b;padding:12px 16px;border-radius:8px;font-size:14px;line-height:1.5}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#1e293b}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:48px;padding:0 16px;border:1px solid #cbd5e1;border-radius:8px;font-size:15px;color:#0f172a;transition:all .2s ease}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#94a3b8}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.form-group[_ngcontent-%COMP%]   input.error[_ngcontent-%COMP%]{border-color:#ef4444}.form-group[_ngcontent-%COMP%]   input.error[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 3px #ef44441a}.form-group[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{font-size:13px;color:#ef4444;font-weight:500}.password-input-wrapper[_ngcontent-%COMP%]{position:relative}.password-input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding-right:48px}.password-input-wrapper[_ngcontent-%COMP%]   .password-toggle[_ngcontent-%COMP%]{position:absolute;right:12px;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;font-size:18px;padding:4px;line-height:1;opacity:.6;transition:opacity .2s ease}.password-input-wrapper[_ngcontent-%COMP%]   .password-toggle[_ngcontent-%COMP%]:hover{opacity:1}.password-input-wrapper[_ngcontent-%COMP%]   .password-toggle[_ngcontent-%COMP%]:focus{outline:none}.submit-button[_ngcontent-%COMP%]{width:100%;height:48px;background:#3b82f6;color:#fff;border:none;border-radius:8px;font-size:16px;font-weight:600;cursor:pointer;box-shadow:0 4px 14px #3b82f666;transition:all .3s ease;margin-top:8px}.submit-button[_ngcontent-%COMP%]:hover:not(:disabled){background:#2563eb;transform:translateY(-2px);box-shadow:0 6px 20px #3b82f680}.submit-button[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.submit-button[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 3px #3b82f64d}.auth-link[_ngcontent-%COMP%]{text-align:center;font-size:14px;color:#64748b;margin-top:8px}.auth-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#3b82f6;font-weight:600;text-decoration:none;transition:color .2s ease}.auth-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#2563eb;text-decoration:underline}@media(max-width:768px){.auth-container[_ngcontent-%COMP%]{padding:20px}.auth-card[_ngcontent-%COMP%]{padding:32px 24px}.auth-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:28px}.auth-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px}}"]})};export{N as SignIn};
